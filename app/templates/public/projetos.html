{% extends "public/base.html" %}

{% block title %}Projetos e Parcerias - Doce Esperança{% endblock %}

{% block content %}
  {% set volunteer_placeholder_src = "data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%27800%27%20height%3D%27600%27%20viewBox%3D%270%200%20800%20600%27%3E%3Crect%20fill%3D%27%23f8fafc%27%20width%3D%27800%27%20height%3D%27600%27/%3E%3Ccircle%20cx%3D%27400%27%20cy%3D%27220%27%20r%3D%27100%27%20fill%3D%27%23cbd5f5%27/%3E%3Cpath%20d%3D%27M260%20520c0-80%2070-140%20140-140s140%2060%20140%20140%27%20fill%3D%27%23cbd5f5%27/%3E%3Ctext%20x%3D%27400%27%20y%3D%27560%27%20text-anchor%3D%27middle%27%20font-family%3D%27Inter%2C%20Arial%2C%20sans-serif%27%20font-size%3D%2760%27%20fill%3D%27%230d47a1%27%3EVolunt%C3%A1rio%3C/text%3E%3C/svg%3E" %}
  {% set support_placeholder_src = "data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%27800%27%20height%3D%27600%27%20viewBox%3D%270%200%20800%20600%27%3E%3Crect%20fill%3D%27%23f8fafc%27%20width%3D%27800%27%20height%3D%27600%27/%3E%3Ccircle%20cx%3D%27400%27%20cy%3D%27220%27%20r%3D%27100%27%20fill%3D%27%23cfe6ff%27/%3E%3Cpath%20d%3D%27M260%20520c0-80%2070-140%20140-140s140%2060%20140%20140%27%20fill%3D%27%23cfe6ff%27/%3E%3Ctext%20x%3D%27400%27%20y%3D%27560%27%20text-anchor%3D%27middle%27%20font-family%3D%27Inter%2C%20Arial%2C%20sans-serif%27%20font-size%3D%2760%27%20fill%3D%27%230d47a1%27%3EApoio%3C/text%3E%3C/svg%3E" %}
  <section id="parcerias" class="section-spacious">
    <div class="container-wide">
      <div class="text-center mb-4">
        <h2 class="fw-bold">Parcerias</h2>
        <p class="text-muted mb-0">Conheça quem caminha conosco para fortalecer nossos projetos.</p>
      </div>
      {% if parceiros %}
        <div class="row g-4">
          {% for parceiro in parceiros %}
            <div class="col-12 col-md-6 col-lg-4">
              <div class="project-card h-100">
                {% if parceiro.logo_path %}
                  <img src="{{ static_url(parceiro.logo_path) }}" alt="Logo {{ parceiro.nome }}" class="card-img-top img-fluid object-fit-contain p-4" style="height: 200px;">
                {% endif %}
                <div class="card-body d-flex flex-column">
                  <h5 class="card-title">{{ parceiro.nome }}</h5>
                  {% if parceiro.descricao %}
                    <p class="card-text">{{ parceiro.descricao }}</p>
                  {% endif %}
                  {% if parceiro.website %}
                    <a class="btn btn-outline-primary mt-auto" href="{{ parceiro.website }}" target="_blank" rel="noopener">
                      Ver detalhes
                    </a>
                  {% else %}
                    <span class="btn btn-outline-secondary disabled mt-auto" tabindex="-1" role="button" aria-disabled="true">
                      Detalhes indisponíveis
                    </span>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-info shadow-sm" role="status">
          {{ (parceiros_placeholder.conteudo if parceiros_placeholder and parceiros_placeholder.conteudo else content_placeholder) | safe }}
        </div>
      {% endif %}
    </div>
  </section>

  <section id="apoios" class="section-spacious project-section apoio-section">
    <div class="container-wide">
      <div class="apoio-section-header text-center mb-5">
        <h2 class="project-section-title apoio-title fw-bold">Redes de Apoio</h2>
        <p class="project-section-subtitle text-muted mb-0">Instituições que contribuem com recursos e iniciativas estratégicas.</p>
      </div>
      {% if apoios %}
        <div class="row g-4">
          {% for apoio in apoios %}
            {% set descricao = (apoio.descricao or '').strip() %}
            {% set has_link = descricao.lower().startswith('http://') or descricao.lower().startswith('https://') %}
            <div class="col-12 col-md-6 col-lg-4">
              <article class="apoio-card h-100">
                <div class="apoio-card-image">
                  {% if apoio.imagem_path %}
                    <img src="{{ static_url(apoio.imagem_path) }}" alt="{{ apoio.titulo }}">
                  {% else %}
                    <img src="{{ support_placeholder_src }}" alt="Rede de apoio">
                  {% endif %}
                </div>
                <div class="apoio-card-body">
                  <h5 class="apoio-card-title mb-3">{{ apoio.titulo }}</h5>
                  {% if descricao and not has_link %}
                    <p class="apoio-card-description mb-0">{{ descricao }}</p>
                  {% elif has_link %}
                    <p class="apoio-card-description mb-0">
                      <a href="{{ descricao }}" target="_blank" rel="noopener" class="apoio-card-link">Visitar site institucional</a>
                    </p>
                  {% else %}
                    <p class="apoio-card-description mb-0">Mais informações em breve.</p>
                  {% endif %}
                </div>
              </article>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-info shadow-sm" role="status">
          {{ (apoios_placeholder.conteudo if apoios_placeholder and apoios_placeholder.conteudo else content_placeholder) | safe }}
        </div>
      {% endif %}
    </div>
  </section>

  <section id="voluntariado" class="section-spacious project-section">
    <div class="container-wide">
      <h2 class="project-section-title text-center mb-3 fw-bold">Voluntariado</h2>
      <p class="project-section-subtitle text-center text-muted mb-5">Pessoas que doam tempo e talento para transformar realidades.</p>
      {% if voluntarios %}
        <div class="row g-4">
          {% for voluntario in voluntarios %}
            <div class="col-12 col-md-6 col-lg-4">
              <div class="project-card h-100">
                {% if voluntario.foto %}
                  <img src="{{ static_url(voluntario.foto) }}" class="card-img-top project-card-img volunteer-card-img" alt="{{ voluntario.nome }}">
                {% else %}
                  <img src="{{ volunteer_placeholder_src }}" class="card-img-top project-card-img volunteer-card-img" alt="Voluntário">
                {% endif %}
                <div class="card-body d-flex flex-column">
                  <h5 class="fw-bold text-dark mb-1">{{ voluntario.nome }}</h5>
                  {% if voluntario.area %}
                    <p class="small text-muted mb-1"><strong>Área:</strong> {{ voluntario.area }}</p>
                  {% endif %}
                  {% if voluntario.disponibilidade %}
                    <p class="small text-muted mb-2"><strong>Disponibilidade:</strong> {{ voluntario.disponibilidade }}</p>
                  {% endif %}
                  {% if voluntario.descricao %}
                    <p class="text-muted mb-0">{{ voluntario.descricao | truncate(200) }}</p>
                  {% else %}
                    <p class="text-muted mb-0">Descrição breve não informada.</p>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-info shadow-sm" role="status">
          {{ (voluntarios_placeholder.conteudo if voluntarios_placeholder and voluntarios_placeholder.conteudo else content_placeholder) | safe }}
        </div>
      {% endif %}
    </div>
  </section>

  <section id="transparencia" class="section-spacious">
    <div class="container-wide">
      <div class="text-center mb-4">
        <h2 class="fw-bold">Portal da Transparência</h2>
        <p class="text-muted mb-0">Acompanhe documentos e relatórios que reforçam nosso compromisso com a transparência.</p>
      </div>
      {% if documentos %}
        <div class="row g-4">
          {% for documento in documentos %}
            <div class="col-12 col-md-6 col-lg-4">
              <div class="card-modern h-100 d-flex flex-column">
                <div class="d-flex flex-column flex-grow-1">
                  <h5 class="card-title">{{ documento.titulo }}</h5>
                  {% if documento.descricao %}
                    <p class="card-text">{{ documento.descricao }}</p>
                  {% endif %}
                  <a class="btn btn-outline-primary mt-auto align-self-start" href="{{ static_url(documento.arquivo_path) }}" target="_blank" rel="noopener">
                    Ver detalhes
                  </a>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-info shadow-sm" role="status">
          {{ (transparencia_placeholder.conteudo if transparencia_placeholder and transparencia_placeholder.conteudo else content_placeholder) | safe }}
        </div>
      {% endif %}
    </div>
  </section>
{% endblock %}
